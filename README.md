# Тестовое задание на тему "Детекция и трекинг футбольного мяча" 

## Датасет
[Датасет SoccerNet](https://github.com/SoccerNet/sn-gamestate?tab=readme-ov-file#manual-downloading-of-soccernet-gamestate)

## Готовые модели
[Готовые модели](https://drive.google.com/drive/folders/1OjVZOkpxtzomTt7k5JNHmKylUlr5-jPO?usp=sharing)

## Финальные обработанные видео
[Видео](https://drive.google.com/drive/folders/1D29nDXVii0QpQhrRS-EG_Tt2sgi5dCuO?usp=sharing)

## Инструкция по запуску
В ходе работы был создан Jupyter Book. Чтобы полностью протестировать его и получить предсказания на видео, стоит просто запускать его по пунктам, обращая внимание на некоторые дополнения в заголовках. Для детекции и трекинга использовалась библиотека **Detectron2**. 

## Основная модель
- **Итерации:** 5000
- **Классы:** 5 (player, referee, goalkeeper, ball, other)

## Дополнительные модели
1. **Модель 1**
   - **Итерации:** 5000
   - **Классы:** 1 (ball)
   - **Использование:** С использованием предобученной model zoo
   - **Результаты:** На видео видны улучшения по сравнению с предыдущей моделью, но все также плохо. [Видео](https://drive.google.com/file/d/1vdDZ0nb4JNEe2wyST9ECyJHy1kf91hbS/view?usp=sharing)

2. **Модель 2**
   - **Итерации:** 5000
   - **Классы:** 1 (ball)
   - **Использование:** БЕЗ использования предобученной model zoo
   - **Результаты:** По итогу дает плохие результаты на challenge части. [Видео](https://drive.google.com/file/d/179wfqIl0lAUncoOvKeg9Bu4XLtCHyQeR/view?usp=sharing)

## Метрики
С подсчетом метрик случилась неудачна. Спустя около 2х часов обработки тестовых изображений, предиктор выдал нулевые результаты. 

![скрин](https://github.com/user-attachments/assets/bcde05af-5618-4712-88dd-aa827fb92e33)

Следующая попытка не удалась. Спустя долгое время ожидания вместо 0.0 метрик, были nan значения. 


## Возможные улучшения
- Обучение на большем количестве итераций (10.000), но для этого нужны большие вычислительные мощности
- Для учучшения трекинга нужно учитывать передвижение главной камеры. Основываясь на координатах её передвижений можно улучшить качетсво трекинга мяча. На данный момент из-за движения основной камеры, линия траектории мяча может быть некорректно из-за привязки к центру мяча.
- Классификация игроков по командам.
- Выполнить подсчет метрики.
  
## Выводы
- Удалось поработать с большим датасетом данных
- Выполнил его форматирования в COCO формат, который нужен для работы с Библиотекой Detectron2
